jQuery.fn.timelinr=function(a){settings=jQuery.extend({orientation:"horizontal",containerDiv:"#timeline",datesDiv:"#dates",datesSelectedClass:"selected",datesSpeed:"normal",issuesDiv:"#issues",issuesSelectedClass:"selected",issuesSpeed:"fast",issuesTransparency:.2,issuesTransparencySpeed:500,prevButton:"#prev",nextButton:"#next",arrowKeys:"false",startAt:1,autoPlay:"false",autoPlayDirection:"forward",autoPlayPause:2e3},a),$(function(){if(0<$(settings.datesDiv).length&&0<$(settings.issuesDiv).length){var a=$(settings.datesDiv+" li").length,b=$(settings.issuesDiv+" li").length,c=$(settings.datesDiv).find("a."+settings.datesSelectedClass),d=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass),e=$(settings.containerDiv).width(),f=$(settings.containerDiv).height(),g=$(settings.issuesDiv).width(),h=$(settings.issuesDiv).height(),i=$(settings.issuesDiv+" li").width(),j=$(settings.issuesDiv+" li").height(),k=$(settings.datesDiv).width(),l=$(settings.datesDiv).height(),m=$(settings.datesDiv+" li").width(),n=$(settings.datesDiv+" li").height();if("horizontal"==settings.orientation){$(settings.issuesDiv).width(i*b),$(settings.datesDiv).width(m*a).css("marginLeft",e/2-m/2);var o=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px")))}else if("vertical"==settings.orientation){$(settings.issuesDiv).height(j*b),$(settings.datesDiv).height(n*a).css("marginTop",f/2-n/2);var o=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px")))}if($(settings.datesDiv+" a").click(function(b){b.preventDefault();var c=$(this).text(),d=$(this).parent().prevAll().length;"horizontal"==settings.orientation?$(settings.issuesDiv).animate({marginLeft:-i*d},{queue:!1,duration:settings.issuesSpeed}):"vertical"==settings.orientation&&$(settings.issuesDiv).animate({marginTop:-j*d},{queue:!1,duration:settings.issuesSpeed}),$(settings.issuesDiv+" li").animate({opacity:settings.issuesTransparency},{queue:!1,duration:settings.issuesSpeed}).removeClass(settings.issuesSelectedClass).eq(d).addClass(settings.issuesSelectedClass).fadeTo(settings.issuesTransparencySpeed,1),1==a?$(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==a?$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?($(settings.prevButton).fadeOut("fast"),$(settings.nextButton).fadeIn("fast")):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&($(settings.nextButton).fadeOut("fast"),$(settings.prevButton).fadeIn("fast")):$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?($(settings.nextButton).fadeIn("fast"),$(settings.prevButton).fadeOut("fast")):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?($(settings.prevButton).fadeIn("fast"),$(settings.nextButton).fadeOut("fast")):$(settings.nextButton+","+settings.prevButton).fadeIn("slow"),$(settings.datesDiv+" a").removeClass(settings.datesSelectedClass),$(this).addClass(settings.datesSelectedClass),"horizontal"==settings.orientation?$(settings.datesDiv).animate({marginLeft:o-m*d},{queue:!1,duration:"settings.datesSpeed"}):"vertical"==settings.orientation&&$(settings.datesDiv).animate({marginTop:o-n*d},{queue:!1,duration:"settings.datesSpeed"})}),$(settings.nextButton).bind("click",function(c){c.preventDefault();var d=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if("horizontal"==settings.orientation){var e=parseInt($(settings.issuesDiv).css("marginLeft").substring(0,$(settings.issuesDiv).css("marginLeft").indexOf("px"))),f=e/i,g=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px"))),h=g-m;e<=-(i*b-i)?($(settings.issuesDiv).stop(),$(settings.datesDiv+" li:last-child a").click()):!$(settings.issuesDiv).is(":animated")&&$(settings.datesDiv+" li").eq(d+1).find("a").trigger("click")}else if("vertical"==settings.orientation){var e=parseInt($(settings.issuesDiv).css("marginTop").substring(0,$(settings.issuesDiv).css("marginTop").indexOf("px"))),f=e/j,g=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px"))),h=g-n;e<=-(j*b-j)?($(settings.issuesDiv).stop(),$(settings.datesDiv+" li:last-child a").click()):!$(settings.issuesDiv).is(":animated")&&$(settings.datesDiv+" li").eq(d+1).find("a").trigger("click")}1==a?$(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==a?$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?($(settings.prevButton).fadeOut("fast"),$(settings.nextButton).fadeIn("fast")):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&($(settings.nextButton).fadeOut("fast"),$(settings.prevButton).fadeIn("fast")):$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?$(settings.prevButton).fadeOut("fast"):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?$(settings.nextButton).fadeOut("fast"):$(settings.nextButton+","+settings.prevButton).fadeIn("slow")}),$(settings.prevButton).click(function(b){b.preventDefault();var c=$(settings.issuesDiv).find("li."+settings.issuesSelectedClass).index();if("horizontal"==settings.orientation){var d=parseInt($(settings.issuesDiv).css("marginLeft").substring(0,$(settings.issuesDiv).css("marginLeft").indexOf("px"))),e=d/i,f=parseInt($(settings.datesDiv).css("marginLeft").substring(0,$(settings.datesDiv).css("marginLeft").indexOf("px"))),g=f+m;0<=d?($(settings.issuesDiv).stop(),$(settings.datesDiv+" li:first-child a").click()):!$(settings.issuesDiv).is(":animated")&&$(settings.datesDiv+" li").eq(c-1).find("a").trigger("click")}else if("vertical"==settings.orientation){var d=parseInt($(settings.issuesDiv).css("marginTop").substring(0,$(settings.issuesDiv).css("marginTop").indexOf("px"))),e=d/j,f=parseInt($(settings.datesDiv).css("marginTop").substring(0,$(settings.datesDiv).css("marginTop").indexOf("px"))),g=f+n;0<=d?($(settings.issuesDiv).stop(),$(settings.datesDiv+" li:first-child a").click()):!$(settings.issuesDiv).is(":animated")&&$(settings.datesDiv+" li").eq(c-1).find("a").trigger("click")}1==a?$(settings.prevButton+","+settings.nextButton).fadeOut("fast"):2==a?$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?($(settings.prevButton).fadeOut("fast"),$(settings.nextButton).fadeIn("fast")):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)&&($(settings.nextButton).fadeOut("fast"),$(settings.prevButton).fadeIn("fast")):$(settings.issuesDiv+" li:first-child").hasClass(settings.issuesSelectedClass)?$(settings.prevButton).fadeOut("fast"):$(settings.issuesDiv+" li:last-child").hasClass(settings.issuesSelectedClass)?$(settings.nextButton).fadeOut("fast"):$(settings.nextButton+","+settings.prevButton).fadeIn("slow")}),"true"==settings.arrowKeys&&("horizontal"==settings.orientation?$(document).keydown(function(a){39==a.keyCode&&$(settings.nextButton).click(),37==a.keyCode&&$(settings.prevButton).click()}):"vertical"==settings.orientation&&$(document).keydown(function(a){40==a.keyCode&&$(settings.nextButton).click(),38==a.keyCode&&$(settings.prevButton).click()})),$(settings.datesDiv+" li").eq(settings.startAt-1).find("a").trigger("click"),"true"==settings.autoPlay){var p=setInterval(autoPlay,settings.autoPlayPause);$(settings.containerDiv).hover(function(){clearInterval(p)},function(){p=setInterval(autoPlay,settings.autoPlayPause)})}}})};function autoPlay(){var a=$(settings.datesDiv).find("a."+settings.datesSelectedClass);"forward"==settings.autoPlayDirection?a.parent().is("li:last-child")?$(settings.datesDiv+" li:first-child").find("a").trigger("click"):a.parent().next().find("a").trigger("click"):"backward"==settings.autoPlayDirection&&(a.parent().is("li:first-child")?$(settings.datesDiv+" li:last-child").find("a").trigger("click"):a.parent().prev().find("a").trigger("click"))}